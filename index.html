<script type="text/javascript">
    let model, maxPredictions;

    async function init() {
      const URL = "https://kld-ai.github.io/000/";  // Ù‡Ø°Ø§ Ø±Ø§Ø¨Ø· Ù…Ù„ÙØ§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙÙŠ GitHub Pages
      const modelURL = URL + "model.json";
      const metadataURL = URL + "metadata.json";

      try {
        model = await tmImage.load(modelURL, metadataURL);
        console.log("âœ… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¬Ø§Ù‡Ø²!");
        maxPredictions = model.getTotalClasses();
      } catch (error) {
        console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:", error);
      }
    }

    const imageUpload = document.getElementById("imageUpload");
    const preview = document.getElementById("preview");
    const confirmButton = document.getElementById("confirmButton");
    let imgLoaded = false;

    imageUpload.addEventListener("change", (event) => {
      const file = event.target.files[0];
      if (!file) return;

      preview.src = URL.createObjectURL(file);
      preview.style.display = "block";
      confirmButton.disabled = false;
      imgLoaded = true;
    });

    confirmButton.addEventListener("click", async () => {
      if (!imgLoaded) return;

      try {
        const prediction = await model.predict(preview, false);
        prediction.sort((a, b) => b.probability - a.probability);
        const bestMatch = prediction[0];
        document.getElementById('result').innerHTML = 
          `ğŸš˜ Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: <span style="color:blue;">${bestMatch.className}</span> <br> ğŸ”¥ Ø§Ù„Ø«Ù‚Ø©: ${(bestMatch.probability * 100).toFixed(2)}%`;
      } catch (error) {
        console.error("âŒ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ†Ø¨Ø¤:", error);
      }
    });

    window.addEventListener('load', init);
</script>
