<script type="text/javascript">
    let model, maxPredictions;

    async function init() {
      const URL = "./"; 
      const modelURL = URL + "model.json";
      const metadataURL = URL + "metadata.json";

      try {
        model = await tmImage.load(modelURL, metadataURL);
        console.log("âœ… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¬Ø§Ù‡Ø²!");
        maxPredictions = model.getTotalClasses();
      } catch (error) {
        console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:", error);
      }
    }

    document.getElementById("imageUpload").addEventListener("change", async (event) => {
      const file = event.target.files[0];
      if (!file) return;

      const img = document.getElementById('preview');
      img.src = URL.createObjectURL(file);
      img.onload = async () => {
        try {
          const prediction = await model.predict(img, false);
          prediction.sort((a, b) => b.probability - a.probability);
          const bestMatch = prediction[0];
          document.getElementById('result').innerHTML = `ğŸš˜ Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: <span style="color:blue;">${bestMatch.className}</span> <br> ğŸ”¥ Ø§Ù„Ø«Ù‚Ø©: ${(bestMatch.probability * 100).toFixed(2)}%`;
        } catch (error) {
          console.error("âŒ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ†Ø¨Ø¤:", error);
        }
      };
    });

    window.addEventListener('load', init);
</script>
